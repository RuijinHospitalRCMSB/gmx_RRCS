<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GMX_RRCS Tutorial</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css">
    <link rel="stylesheet" href="./css/example.css">
</head>
<body>

    <!-- <div class="sidebar">
        <ul class="sidebar-nav" id="sidebarNav">
            <li><a href="#intro">Introduction</a></li>
            <li><a href="#prerequisites">Prerequisites</a></li>
            <li><a href="#step1">Step 1: Data Preparation</a></li>
            <li><a href="#step2">Step 2: CLI Usage</a></li>
            <li><a href="#step3">Step 3: Visualization</a></li>
            <li><a href="#resources">Additional Resources</a></li>
        </ul>
    </div> -->
    <div id="sidebarNav"></div>

    <div class="main-content">
        <!-- Introduction -->
        <section id="intro">
            <h1>Tutorial 1: Residue Contact Analysis of Lysozyme MD Analysis</h1>
            <img src="./image/Lysozyme.png" class="tutorial-image">
            <p>This comprehensive tutorial demonstrates residue-residue contact analysis using GMX_RRCS with lysozyme MD simulation data. GMX_RRCS is a tool designed for analyzing residue-residue contact scores (RRCS) in molecular dynamics (MD) simulations. This tutorial will guide you through the entire process, from setting up the simulation data to computing and visualizing RRCS results. By following this guide step by step, you will learn how to efficiently use GMX_RRCS to analyze protein interactions.</p>
            <!-- 添加 TOC -->
            <strong>Table of Contents</strong>
            <div class="table-of-contents">
                <ul>
                    <li><a href="#intro">Introduction</a></li>
                    <li><a href="#prerequisites">Prerequisites</a></li>
                    <li><a href="#step1">Step 1: Preparing the Simulation Data</a></li>
                    <li><a href="#step2">Step 2: Using the Command Line Interface (CLI)</a></li>
                    <li><a href="#step3">Step 3: Visualizing RRCS Data</a></li>
                    <li><a href="#resources">Additional Resources</a></li>
                </ul>
            </div>
        </section>

        <!-- Prerequisites -->
        <section id="prerequisites">
            <h2>Prerequisites</h2>
            <p>Before starting, ensure you have the following installed:</p>
            <ul>
                <li><a href="https://www.gromacs.org/" target="_blank">GROMACS</a> for molecular dynamics simulation.</li>
                <li><a href="./index.html#installation" target="_blank">GMX_RRCS</a> installed on your system.</li>
                <li><a href="https://www.python.org/" target="_blank">Python (3.7 or later)</a> with necessary dependencies such as NumPy and Matplotlib.</li>
                    <pre><code># Install required dependencies
pip install gmx_rrcs numpy matplotlib MDAnalysis</code></pre>
                <!-- <li>Sample data files:
                    <ul>
                        <li><code>md_0_1.xtc</code> - Trajectory file</li>
                        <li><code>md_0_1.tpr</code> - Topology file</li>
                        <li><code>Snapshot-0ns.pdb</code> - Initial structure</li>
                    </ul>
                </li> -->
            </ul>
        </section>

        <!-- Step 1 -->
        <section id="step1">
            <h2>Step 1: Preparing the Simulation Data</h2>
            <p>This step is optional and requires you to process the trajectory using GROMACS. However, we strongly recommend thoroughly processing the trajectory before computing RRCS, as this significantly impacts the program's performance and efficiency. This tutorial uses a <a href="http://www.mdtutorials.com/gmx/lysozyme/index.html" target="_blank">classic GROMACS lysozyme MD case</a> to demonstrate RRCS analysis.</p>
            <p>After running the simulation, you will obtain an XTC file containing trajectory data. To extract a protein-only trajectory with a time step of 0.1 ns over 300 ns, run:</p>
            <pre><code>echo 2 2 2 | gmx trjconv \
-f md_0_1.xtc \           # Input trajectory
-s md_0_1.tpr \           # Topology file
-fit rot+trans \          # Rotational/translational fitting
-center \                 # Center protein
-dt 100 \                 # 100ps interval (0.1ns)
-b 200000 \               # Start at 200ns
-e 300000 \               # End at 300ns
-o md_0_1_processed.xtc   # Output file</code></pre>
            <div class="note">
                <strong>Note 1:</strong><br/>
                The command <code>echo 2 2 2</code> is used to pass interactive options to gmx trjconv, eliminating the need for manual input.
                <ul>
                    <li>
                        The first 2 selects the atom group for least squares fitting, which in this case includes all non-hydrogen atoms of the protein.
                    </li>
                    <li>
                        The second 2 specifies the atom group for centering, also choosing all non-hydrogen atoms of the protein to ensure that the trajectory remains centered around this molecule.
                    </li>
                    <li>
                    The third 2 determines the output atom group, meaning the trajectory file will contain only the selected non-hydrogen atoms of the protein.
                    </li>
                </ul>
                This approach allows the command to run automatically, improving efficiency by avoiding interactive selection.
            </div>
            <div class="note">
                <strong>Note 2:</strong>
                <ul>
                    <li>
                        The processed trajectory file <code>md_0_1_processed.xtc</code> has been optimized, reducing its size significantly from 12GB to 12MB.
                    </li>
                    <li>
                        You can <a href="./data/md_0_1_processed.xtc" download>click here to download</a> the processed trajectory file.
                    </li>
                </ul>
            </div>
            <div>
                <p>After processing the trajectory, we need to generate a topology file (<code>md_0_1_processed_dump0.gro</code>) that exactly matches the processed trajectory (<code>md_0_1_processed.xtc</code>), ensuring consistency in atom numbers and other key information. Run the following commands:</p>
            </div>
            <pre><code>echo 2 | gmx convert-tpr \
-s md_0_1.tpr \
-o md_0_1_processed.tpr            # Output a new TPR file that matche the processed trajectory.

echo 2 | gmx trjconv \
-f md_0_1_processed.xtc \
-s md_0_1_processed.tpr \
-o md_0_1_processed_dump0.gro \    # Output the GRO format coordinate file.
-dump 0                            # Extracts structure information at 0 ps.
            </code></pre>
            <div class="note">
                <strong>Note:</strong>
                <ul>
                    <li>
                        The first command <code>gmx convert-tpr</code> creates a new TPR file (<code>md_0_1_processed.tpr</code>) that matches the processed trajectory, ensuring consistency during analysis.
                    </li>
                    <li>
                        The second command <code>gmx trjconv</code> extracts the coordinates at 0 ps from the trajectory, generating a GRO format structure file (<code>md_0_1_processed_dump0.gro</code>), which can later be converted to PDB for visualization and further analysis.
                    </li>
                    <li>
                        <a href="./data/md_0_1_processed_dump0.gro" download>Click here to download</a> the processed topology file.
                    </li>
                </ul>
            </div>
            <div>
                <p>
                    At this point, we have successfully completed the trajectory preprocessing. The next step is to proceed with GMX_RRCS analysis.
                </p>
                <p>
                    Before moving forward, here's a useful tip: During the preprocessing stage, you can extract only the atomic groups required for the RRCS calculation to optimize efficiency. For example, if you only need to compute RRCS for two specific residues between 100 ns and 200 ns, you can extract only those residues within this time range during preprocessing. This approach significantly reduces the trajectory file size and greatly accelerates the computation process, making the analysis much more efficient.
                </p>
            </div>
        </section>

        <!-- Step 2 -->
        <section id="step2">
            <h2>Step 2: Using the Command Line Interface computing RRCS</h2>
            <p>After preprocessing the trajectory, we can now compute Residue-Residue Contact Strength (RRCS) using GMX_RRCS. We assume that GMX_RRCS has already been installed, and you can execute the following command to perform the calculation:</p>
            <pre><code>gmx_RRCS \
--top_file md_0_1_processed_dump0.gro \      # PDB topology
--traj_file md_0_1_processed.xtc \           # Preprocessed trajectory file
--res_file tutorial_1_residue_pair.txt \     # File specifying the residue pairs for RRCS calculation
--output_dir . \                             # Output directory
--output_file tutorial_1_rrcs_result.txt \   # Output file(s)
--num_processes 100                          # Number of processes for parallel computation
--filter_threshold 0.0                       # Export results above 0.0 to a specified file</code></pre>
            <div class="note">
                <strong>Note:</strong>
                <ul>
                    <li>
                        Specifying the residue pair file:
                        <p>
                            You must specify a file containing the residue pairs for RRCS calculation using the <code>--res_file</code> parameter. For formatting rules, <a href="./index.html#residue-pair"> to this guide</a>. The file used in this example, <code>tutorial_1_residue_pair.txt</code>, can be <a href="./data/tutorial_1_residue_pair.txt">downloaded here</a>.
                        </p>
                    </li>
                    <li>
                        Output file format:
                        <p>
                            The calculated RRCS values will be saved in tutorial_1_rrcs_result.txt, with a format similar to the following:
                            <pre><code>Frame  Residue1       Residue2       RRCS                    
1      SYSTEM:121GLN  SYSTEM:119ASP  0.25705056871686655
1      SYSTEM:121GLN  SYSTEM:124ILE  1.6024710655212397 
1      SYSTEM:121GLN  SYSTEM:125ARG  1.1029357705797465 
1      SYSTEM:121GLN  SYSTEM:24SER   1.9814428533826551 
1      SYSTEM:121GLN  SYSTEM:25LEU   5.636771638052803  
1      SYSTEM:121GLN  SYSTEM:26GLY   3.5703242233821317 
1      SYSTEM:124ILE  SYSTEM:121GLN  1.6024710655212397 
1      SYSTEM:124ILE  SYSTEM:129LEU  1.8078749656677244 
...</code></pre>
                        </p>
                        <p>
                            You can <a href="./data/tutorial_1_rrcs_result.txt">download the output file</a> <code>tutorial_1_rrcs_result.txt</code>, and the <a href="./data/tutorial_1_rrcs_result_filter_rrcs_greater_than_0.0.txt">filter result</a> (<code>tutorial_1_rrcs_result_filter_rrcs_greater_than_0.0.txt</code>).
                        </p>
                    </li>
                    <li>
                        Understanding the “SYSTEM” tag:
                        <p>
                            In the output file, the <code>SYSTEM</code> tag appears in place of chain identifiers. If the original trajectory and topology files do not contain explicit chain information, GMX_RRCS will default to labeling all residues as belonging to the first chain, denoted as <code>SYSTEM</code>.
                        </p>
                    </li>
                </ul>
            </div>
        </section>

        <!-- Step 3 -->
        <section id="step3">
            <h2>Step 3: Visualizing RRCS Data</h2>
            <p>
                After completing the RRCS calculation, we will now demonstrate some example analyses. Please note that these are just a few possible use cases of RRCS, and you can tailor the analysis to your specific research objectives.
            </p>
            <h3>Example 1: Temporal Evolution of RRCS Between Two Residues</h3>
            <p>
                In this example, we analyze how the RRCS between Residue <code>PHE34</code> and Residue <code>ARG114</code> changes over time. A line plot is generated to visualize the interaction dynamics between these two residues throughout the simulation. You can generate the RRCS plot using the following command:
            </p>
            <pre><code>plot_rrcs_line tutorial_1_rrcs_result.txt tutorial_1_rrcs_result.png SYSTEM:34PHE-SYSTEM:114ARG -w 15</code></pre>
            <div class="note">
                <strong>Note:</strong>
                <ul>
                    <li>
                        <code>plot_rrcs_line</code> is a built-in plotting tool in <code>gmx_RRCS</code>, which is automatically installed with <code>gmx_RRCS</code>. If the default tool does not meet your needs, you can <a href="./data/plot_line.py">click here</a> to access the Python source code for further customization.
                    </li>
                    <li>
                        You can run plot_rrcs_line -h to check all available parameters. Notably, <code>SYSTEM:34PHE-SYSTEM:114ARG</code> specifies the residue pair to be analyzed, and you must ensure that tutorial_1_rrcs_result.txt contains data for this residue pair; otherwise, the plot cannot be generated correctly.
                    </li>
                </ul>
            </div>
            <div> 
                <p>
                    After executing the command, you will obtain a line plot that depicts the temporal evolution of RRCS (Example output file: tutorial_1_rrcs_result.png).
                    <ul>
                        <li>
                            X-axis: Represents the frames of the simulation trajectory, indicating different time points in the simulation.
                        </li>
                        <li>
                            Y-axis: Represents RRCS (Relative Residue Contact Strength), which quantifies the strength of interaction between the specified residue pair over time.
                        </li>
                    </ul>
                </p>
                <img src="./image/tutorial_1_rrcs_line.png" class="tutorial-image" style="max-width: 100%; margin-top: 0.5rem 0; margin-bottom: 1rem 0;">
                <p>
                    This plot allows you to observe how the interaction between Residue PHE34 and Residue ARG114 changes over time. You may identify trends such as increasing or decreasing interaction strength and detect stable interaction patterns within the simulation.
                </p>
            </div>
            <h3>Example 2: Correlation between Mindist and RRCS</h3>
            <p>
                In this example, we analyze the correlation between Minimum Distance (Mindist) and Relative Residue Contact Strength (RRCS).
            </p>
            <p>
                First, we create an index file that includes Residues PHE34 and ARG114. After executing the following command, enter <code>2 & r 25</code> and <cord>2 & r 124</cord> to select the respective residues:
            </p>
            <pre><code>gmx make_ndx -f md_0_1_processed.tpr -o md_0_1_processed.ndx</code></pre>
            <p>
                Next, we use the gmx mindist command to compute the minimum distance between LEU25 and ILE124:
            </p>
            <pre><code>echo 10 11 | gmx mindist -f md_0_1_processed.xtc -s md_0_1_processed.tpr -n md_0_1_processed.ndx -od md_0_1_processed_mindist.xvg</code></pre>
            <div class="note">
                <strong>Note:</strong>
                <ul>
                    <li>
                        <code>echo 10 11</code> specifies indices 10 and 11, corresponding to LEU25 and ILE124 in the index file md_0_1_processed.ndx.
                    </li>
                    <li>
                        You can click here to <a href="./data/md_0_1_processed.ndx">download</a> the md_0_1_processed.ndx or <a href="./data/md_0_1_processed_mindist.xvg">download</a> md_0_1_processed_mindist.xvg files.
                    </li>
                </ul>
            </div>
            <p>
                Next, We plot Mindist (X-axis) against RRCS (Y-axis) to visualize their relationship. It is important to highlight the fundamental methodological differences between RRCS and minimum distance (Mindist):
            </p>
            <img src="./image/tutorial_1_rrcs_mindist.svg" class="tutorial-image" style="max-width: 100%; margin-top: 0.5rem 0; margin-bottom: 1rem 0;">
            <div class="note">
                <strong>Note:</strong>
                <ul>
                    <li>
                        Minimum Distance (Mindist) considers only the shortest interatomic separation between two residues, making it a single-point measurement.
                    </li>
                    <li>
                        RRCS, on the other hand, integrates contributions from all heavy atoms within a defined cutoff range, providing a cumulative measure of contact strength.
                    </li>
                </ul>
            </div>
            <p>
                Due to this methodological distinction, RRCS captures richer multi-atom interaction information, including transient yet significant dynamic contacts, which the minimum distance metric inherently overlooks, especially in cases involving tight, fluctuating interactions.
            </p>
            <h3>Example 3: Generating a Bar Chart of the Total RRCS for Specific Residues</h3>
            <p>
                In this example, we generate a bar chart displaying the total RRCS of specific residues with all other residues, providing an intuitive visualization of their interaction strength with the surrounding environment. Run the following command:
            </p>
            <pre><code>gmx_rrcs_count -i tutorial_1_rrcs_result.txt -o tutorial_1_rrcs_bar.png -r '26,33,34,121,124'</code></pre>
            <img src="./image/tutorial_1_rrcs_bar.png" class="tutorial-image" style="max-width: 100%; margin-top: 0.5rem 0; margin-bottom: 1rem 0;">
            <div class="note">
                <strong>Note:</strong>
                <ul>
                    <li>
                        <code>gmx_rrcs_count</code> is a sub-tool of gmx_RRCS, which is installed automatically with <code>gmx_RRCS</code>. If the default tool does not meet your needs, you can <a href="./data/plot_rrcs_count.py">click here</a> to access the Python source code for further customization.
                    </li>
                    <li>
                        You can check the details of each parameter by running <code>gmx_rrcs_count -h</code>.
                    </li>
                </ul>
            </div>
        </section>

        <!-- Resources -->
        <section id="resources">
            <h2>Additional Resources</h2>
            <ul>
                <li>Official Documentation: <a href="https://github.com/RuijinHospitalRCMSB/gmx_RRCS">GitHub Repository</a></li>
                <li>Simulation Tutorial: <a href="http://www.mdtutorials.com/gmx/lysozyme">GROMACS Lysozyme Tutorial</a></li>
                <li>Visualization Tools:
                    <ul>
                        <li><a href="https://www.cgl.ucsf.edu/chimerax/">UCSF ChimeraX</a></li>
                        <li><a href="https://www.ks.uiuc.edu/Research/vmd/">VMD</a></li>
                        <li><a href="https://www.pymol.org/">PyMOL</a></li>
                    </ul>
                </li>
            </ul>
            <div class="note">
                <strong>Technical Support:</strong>
                <p>Contact <a href="">zhouqt@fudan.edu.cn</a> for assistance</p>
            </div>
        </section>
    </div>

    <!-- 先加载 highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js"></script>
    
    <!-- 然后加载我们的 JS -->
    <script src="./js/example.js"></script>
</body>
</html>